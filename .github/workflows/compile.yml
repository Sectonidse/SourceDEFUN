# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

name: Game

on: [release, pull_request, workflow_dispatch]

env:
  # Configuration type to build.
  BUILD_CONFIGURATION: Debug

permissions:
  contents: read

jobs:
  Windows:
    if: false # Disable Windows Compilation, Reason: make doesn't compile, needs a contributor with Windows system to fix it.
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v4

    # On Windows runners, let's ensure to have the Developer Command Prompt environment setup correctly.
    # As used here the Developer Command Prompt created is targeting x64 and using the default the Windows SDK.
    - uses: ilammy/msvc-dev-cmd@v1
    
    - name: Prepare to Build
      working-directory: ${{env.GITHUB_WORKSPACE}}
      run: cmake -S . -B ./BUILD

    - name: Compile
      working-directory: ${{env.GITHUB_WORKSPACE}}
      run: cd ./BUILD && make

  Linux:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Dependencies
      working-directory: ${{env.GITHUB_WORKSPACE}}
      run: |
        sudo apt remove lib32gcc-s1
        cd ./thirdparty/gcc
        sudo apt install ./cpp-81.deb ./g++-81.deb ./g++-multilib-81.deb ./gcc-81.deb ./gcc-base-81.deb ./gcc-locales-81_all.deb ./gcc-multilib-81.deb ./libstdc++6-dev_81.deb ./libmpfr4_3.1.3-2_amd64.deb
      
    - name: Prepare to build
      working-directory: ${{env.GITHUB_WORKSPACE}}
      run: cmake -S . -B ./BUILD

    - name: Compile
      working-directory: ${{env.GITHUB_WORKSPACE}}
      run: cd ./BUILD && make
